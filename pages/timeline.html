<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Exhibit Timeline - Roger Williams Exhibit</title>
    <link rel="stylesheet" href="../css/variables.css">
    <link rel="stylesheet" href="../css/styles.css">
    <style>
        /* Timeline specific overrides */
        .timeline-section h2 {
            border-bottom: 2px solid var(--color-primary-gold);
            padding-bottom: var(--spacing-xs);
            margin-bottom: var(--spacing-md);
        }
    </style>
</head>

<body>
    <header class="site-header">
        <div class="container">
            <a href="../index.html" class="header-branding" style="text-decoration: none;">
                <img src="../assets/dimensional-v-white.png" alt="Vanderbilt University" class="header-lockup">
                <div class="header-separator"></div>
                <div class="header-sub-text">Peabody Library | Roger Williams Exhibit</div>
            </a>
            <button class="nav-toggle" aria-label="Toggle navigation" aria-expanded="false">
                <span class="hamburger-line"></span>
                <span class="hamburger-line"></span>
                <span class="hamburger-line"></span>
            </button>
            <nav class="main-nav">
                <ul>
                    <li><a href="../index.html">Home</a></li>
                    <li><a href="timeline.html">Explore Timeline</a></li>
                    <li><a href="about.html">About the Exhibit</a></li>
                </ul>
            </nav>
        </div>
    </header>

    <main class="container section">
        <div class="timeline-header">
            <h1>Roger Williams University Timeline</h1>
            <p class="timeline-subtitle">Explore the complete chronological history</p>
        </div>

        <!-- Progress Indicator -->
        <div class="progress-container">
            <div class="progress-info">
                <span class="progress-text" id="progress-text">Section 1 of 12</span>
                <span class="badge badge-gold" id="progress-badge">Wall 1</span>
            </div>
            <div class="interactive-timeline-track" id="interactive-track">
                <!-- Nodes injected by JS -->
            </div>
        </div>

        <!-- Main Panel Content -->
        <div class="panel-card wall-1" id="panel-card-bg">
            <h2 class="year-heading" id="year-heading">1833</h2>
            <h3 class="panel-title" id="panel-title">First Black School in Nashville</h3>
        </div>

        <!-- Gallery Wall Text Accordion -->
        <details class="accordion-custom accordion-gold" id="gallery-accordion">
            <summary>
                <div class="summary-inner">
                    <span class="icon-circle icon-gold">W</span>
                    <h4>From the Gallery Walls</h4>
                </div>
                <span class="chevron"></span>
            </summary>
            <div class="details-content" id="gallery-content">
                <p style="margin-bottom: var(--spacing-sm);">Alphonso Sumner, a free Black barber, organizes Nashville's
                    first "school" for Black children—a collection of classes that preceded white missionaries' efforts
                    by three decades. These classes operated intermittently, running only a few months each year due to
                    periodic outbreaks of cholera and smallpox.</p>
                <p>However, these efforts ended abruptly after Sumner was accused of writing letters to a local fugitive
                    slave in the North—he received a public whipping and was forced to close the school and flee to
                    Cincinnati.</p>
            </div>
        </details>

        <!-- Additional Context Accordion -->
        <details class="accordion-custom accordion-blue" id="context-accordion" open>
            <summary>
                <div class="summary-inner">
                    <span class="icon-circle icon-blue">+</span>
                    <h4>Additional Context</h4>
                </div>
            </summary>
            <div class="details-content" id="context-content">
                <p>[ENTER CONTENT HERE - Information about the period between Alphonso Sumner's forced closure and the
                    reopening efforts, including community responses and underground educational efforts during
                    1833-1836]</p>
            </div>
        </details>

        <div class="nav-buttons">
            <button class="btn-nav btn-prev" id="btn-prev" disabled>
                <span class="arrow">‹</span> Previous
            </button>
            <button class="btn-nav btn-next" id="btn-next">
                Next <span class="arrow">›</span>
            </button>
        </div>

    </main>

    <footer class="site-footer">
        <div class="container">
            <p>&copy; 2026 Vanderbilt University - Peabody Library</p>
        </div>
    </footer>

    <script src="../js/main.js"></script>
    <script>
        document.addEventListener('DOMContentLoaded', () => {
            const timelineData = [
                { year: "1833", wall: "Wall 1", title: "First Black School in Nashville", contextPlaceholder: "Information about the period between Alphonso Sumner's forced closure and the reopening efforts, including community responses and underground educational efforts during 1833-1836" },
                { year: "1836", wall: "Wall 1", title: "Growth of Native Black Schools (1836-1850)", contextPlaceholder: "Details about the growth of Black education in Nashville during the 1840s-1850s and early Civil War period, leading up to the establishment of the Nashville Normal and Theological Institute" },
                { year: "1864", wall: "Wall 1", title: "Origins of the Nashville Normal and Theological Institute", contextPlaceholder: "" },
                { year: "1867", wall: "Wall 1", title: "Formal Incorporation", contextPlaceholder: "" },
                { year: "1874", wall: "Wall 1", title: "Campus Development on Hillsboro Pike", contextPlaceholder: "" },
                { year: "1881", wall: "Wall 1", title: "Rising Enrollment and Prestige", contextPlaceholder: "" },
                { year: "1885", wall: "Wall 1", title: "Transitions and Challenges", contextPlaceholder: "" },
                { year: "1890-1899", wall: "Wall 1", title: "The End of an Era", contextPlaceholder: "" },
                { year: "1900", wall: "Wall 2", title: "Recognition and Expansion", contextPlaceholder: "" },
                { year: "1905", wall: "Wall 2", title: "The Fire and Relocation", contextPlaceholder: "" },
                { year: "1908", wall: "Wall 2", title: "A New Beginning on White's Creek Pike", contextPlaceholder: "" },
                { year: "1929", wall: "Wall 2", title: "Closure and Legacy", contextPlaceholder: "" }
            ];

            const interactiveTrack = document.getElementById('interactive-track');
            const progressText = document.getElementById('progress-text');
            const progressBadge = document.getElementById('progress-badge');
            const yearHeading = document.getElementById('year-heading');
            const panelTitle = document.getElementById('panel-title');
            const contextContent = document.getElementById('context-content');
            const galleryContent = document.getElementById('gallery-content');
            const galleryAccordion = document.getElementById('gallery-accordion');

            const btnPrev = document.getElementById('btn-prev');
            const btnNext = document.getElementById('btn-next');

            let currentIndex = 0;
            let nodePopover, popoverYear, popoverBtn;
            let activePopoverIndex = -1;

            // Initialize Nodes
            function initTimelineNodes() {
                interactiveTrack.innerHTML = '';

                // Add background line
                const trackLine = document.createElement('div');
                trackLine.className = 'timeline-line';
                interactiveTrack.appendChild(trackLine);

                // Add fill line
                const fillLine = document.createElement('div');
                fillLine.className = 'timeline-line-fill';
                fillLine.id = 'timeline-fill';
                interactiveTrack.appendChild(fillLine);

                // Add Popover
                nodePopover = document.createElement('div');
                nodePopover.className = 'node-popover';
                nodePopover.style.display = 'none';

                popoverYear = document.createElement('span');
                popoverYear.className = 'popover-year';

                popoverBtn = document.createElement('button');
                popoverBtn.className = 'popover-btn';
                popoverBtn.textContent = 'Visit Section';

                nodePopover.appendChild(popoverYear);
                nodePopover.appendChild(popoverBtn);
                interactiveTrack.appendChild(nodePopover);

                popoverBtn.addEventListener('click', (e) => {
                    e.stopPropagation();
                    if (activePopoverIndex !== -1) {
                        currentIndex = activePopoverIndex;
                        updateUI();
                        updateURL();
                        nodePopover.style.display = 'none';
                        activePopoverIndex = -1;
                    }
                });

                // Add node container
                const nodesContainer = document.createElement('div');
                nodesContainer.className = 'timeline-nodes-container';

                timelineData.forEach((item, index) => {
                    const node = document.createElement('div');
                    node.className = 'timeline-node';

                    // Set precise position along the line
                    const positionPercentage = (index / (timelineData.length - 1)) * 100;
                    node.style.left = `${positionPercentage}%`;

                    if (index === currentIndex) node.classList.add('active');
                    if (index < currentIndex) node.classList.add('completed');

                    node.addEventListener('click', (e) => {
                        e.stopPropagation();
                        if (activePopoverIndex === index) {
                            nodePopover.style.display = 'none';
                            activePopoverIndex = -1;
                        } else {
                            activePopoverIndex = index;
                            popoverYear.textContent = item.year;
                            nodePopover.style.left = `${positionPercentage}%`;
                            nodePopover.style.display = 'flex';
                        }
                    });
                    nodesContainer.appendChild(node);
                });
                interactiveTrack.appendChild(nodesContainer);

                // Close popover if clicking outside
                document.addEventListener('click', () => {
                    if (nodePopover && nodePopover.style.display === 'flex') {
                        nodePopover.style.display = 'none';
                        activePopoverIndex = -1;
                    }
                });
            }

            function updateUI() {
                if (nodePopover && nodePopover.style.display === 'flex') {
                    nodePopover.style.display = 'none';
                    activePopoverIndex = -1;
                }
                const item = timelineData[currentIndex];

                // Update Progress Text
                progressText.textContent = `Section ${currentIndex + 1} of ${timelineData.length}`;
                if (item.wall) {
                    progressBadge.style.display = 'inline-block';
                    progressBadge.textContent = item.wall;
                } else {
                    progressBadge.style.display = 'none';
                }

                // Update fill line width
                const fillLine = document.getElementById('timeline-fill');
                if (fillLine) {
                    const fillPercentage = (currentIndex / (timelineData.length - 1)) * 100;
                    fillLine.style.width = `${fillPercentage}%`;
                }

                // Update Card Texts
                yearHeading.textContent = item.year;
                panelTitle.textContent = item.title;

                // Update Accordions
                galleryAccordion.removeAttribute('open');

                if (currentIndex === 0) {
                    galleryContent.innerHTML = `<p style="margin-bottom: var(--spacing-sm);">Alphonso Sumner, a free Black barber, organizes Nashville's first "school" for Black children—a collection of classes that preceded white missionaries' efforts by three decades. These classes operated intermittently, running only a few months each year due to periodic outbreaks of cholera and smallpox.</p><p>However, these efforts ended abruptly after Sumner was accused of writing letters to a local fugitive slave in the North—he received a public whipping and was forced to close the school and flee to Cincinnati.</p>`;
                } else {
                    galleryContent.innerHTML = `<p>[ENTER GALLERY TEXT HERE]</p>`;
                }

                if (item.contextPlaceholder) {
                    contextContent.innerHTML = `<p>[ENTER CONTENT HERE - ${item.contextPlaceholder}]</p>`;
                } else {
                    contextContent.innerHTML = `<p>[ENTER CONTENT HERE]</p>`;
                }

                // Update Nodes Active State
                const nodes = interactiveTrack.querySelectorAll('.timeline-node');
                nodes.forEach((node, index) => {
                    node.classList.remove('active', 'completed');
                    if (index === currentIndex) {
                        node.classList.add('active');
                    } else if (index < currentIndex) {
                        node.classList.add('completed');
                    }
                });

                // Update Navigation Buttons
                btnPrev.disabled = currentIndex === 0;
                btnNext.disabled = currentIndex === timelineData.length - 1;
            }

            function updateURL() {
                const year = timelineData[currentIndex].year;
                const newUrl = window.location.protocol + "//" + window.location.host + window.location.pathname + '?year=' + year;
                window.history.pushState({ path: newUrl }, '', newUrl);

                // Auto scroll to top on nav
                window.scrollTo({ top: 0, behavior: 'smooth' });
            }

            function checkURL() {
                const params = new URLSearchParams(window.location.search);
                const year = params.get('year');
                if (year) {
                    const foundIndex = timelineData.findIndex(item => item.year === year);
                    if (foundIndex !== -1) {
                        currentIndex = foundIndex;
                    }
                }
            }

            // Event Listeners for Nav
            btnPrev.addEventListener('click', () => {
                if (currentIndex > 0) {
                    currentIndex--;
                    updateUI();
                    updateURL();
                }
            });

            btnNext.addEventListener('click', () => {
                if (currentIndex < timelineData.length - 1) {
                    currentIndex++;
                    updateUI();
                    updateURL();
                }
            });

            window.addEventListener('popstate', () => {
                checkURL();
                updateUI();
            });

            // Initial Load
            checkURL();
            initTimelineNodes();
            updateUI();
        });
    </script>
</body>

</html>